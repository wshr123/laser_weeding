<!-- <launch> -->
<!--      --><!-- USB摄像头节点 -->
<!--     <node pkg="usb_cam" type="usb_cam_node" name="usb_cam" output="screen"> -->
<!--         <param name="video_device" value="/dev/video4" /> -->
<!--         <param name="image_width" value="640" /> -->
<!--         <param name="image_height" value="480" /> -->
<!--         <param name="pixel_format" value="yuyv" /> -->
<!--         <param name="camera_frame_id" value="usb_cam" /> -->
<!--         <param name="io_method" value="mmap"/> -->
<!--         <param name="framerate" value="30" /> -->
<!--         <remap from="usb_cam/image_raw" to="/camera/image_raw" /> -->
<!--     </node> -->

<!--      --><!-- 增强激光除草节点 -->
<!--     <node pkg="laser_weeding" type="main.py" name="laser_weeding_node" output="screen" required="true"> -->
<!--          --><!-- 模型参数 -->
<!--         <param name="model_type" value="yolov11" /> -->
<!--         <param name="model_path" value="/home/zhong/my_workspace/src/laser_weeding/weights/yolo11m.pt" /> -->
<!--         <param name="device" value="0" /> -->

<!--          --><!-- 跟踪器参数 -->
<!--         <param name="tracker_type" value="custom" /> -->

<!--          --><!-- 类别ID -->
<!--         <param name="weed_class_id" value="64" /> -->
<!--         <param name="crop_class_id" value="0" /> -->
<!--         <param name="confidence_threshold" value="0.3" /> -->

<!--          --><!-- 激光参数 -->
<!--         <param name="laser_duration" value="0.1" /> -->

<!--          --><!-- 延迟补偿参数 (单位: 秒) -->
<!--         <param name="total_system_delay" value="0.08" />        --><!-- 总系统延迟80ms -->
<!--         <param name="camera_delay" value="0.033" />             --><!-- 相机延迟33ms -->
<!--         <param name="processing_delay" value="0.02" />          --><!-- 处理延迟20ms -->
<!--         <param name="galvo_delay" value="0.01" />               --><!-- 振镜延迟10ms -->
<!--         <param name="communication_delay" value="0.005" />      --><!-- 通信延迟5ms -->
<!--         <param name="extra_prediction" value="0.02" />          --><!-- 额外预测20ms -->

<!--          --><!-- 预测参数 -->
<!--         <param name="max_prediction_distance" value="100" />    --><!-- 最大预测距离 -->
<!--         <param name="use_kalman_filter" value="true" />         --><!-- 使用卡尔曼滤波 -->
<!--         <param name="adaptive_prediction" value="true" />       --><!-- 自适应预测 -->

<!--          --><!-- 实时跟踪参数 -->
<!--         <param name="realtime_tracking" value="true" />         --><!-- 启用实时跟踪 -->
<!--         <param name="tracking_frequency" value="100" />         --><!-- 100Hz跟踪频率 -->

<!--          --><!-- 串口参数 -->
<!--         <param name="serial_port" value="/dev/ttyACM0" /> -->
<!--         <param name="serial_baudrate" value="115200" /> -->

<!--          --><!-- 图像参数 -->
<!--         <param name="image_width" value="640" /> -->
<!--         <param name="image_height" value="480" /> -->
<!--     </node> -->
<!-- </launch> -->
<launch>
    <!-- 激光除草节点 -->
    <node pkg="laser_weeding" type="main.py" name="laser_weeding_node" output="screen" required="true">
        <!-- 模型参数 -->
        <param name="model_type" value="yolov11" />
        <param name="model_path" value="/home/zhong/runs/detect/fake_intra/weights/best.pt" />
        <param name="device" value="0" />
        <param name="tracker_type" value="bytetrack" />

        <!-- 检测参数 -->
        <param name="weed_class_id" value="0" />
        <param name="confidence_threshold" value="0.3" />

        <!-- 核心预测参数 -->
        <param name="total_delay" value="0.08" />
        <param name="prediction_time" value="0.5" />
        <param name="use_kalman" value="true" />
        <param name="max_prediction_distance" value="200" />

        <!-- 激光控制 -->
        <param name="aiming_time" value="0.15" />
        <param name="laser_time" value="0.4" />

        <!-- 振镜参数 -->
        <param name="serial_port" value="/dev/ttyACM0" />
        <param name="serial_baudrate" value="115200" />
        <param name="min_move_step" value="0" />

        <!-- 图像参数 -->
        <param name="image_width" value="640" />
        <param name="image_height" value="480" />
        <param name="image_topic" value="/camera/image_raw" />
        <param name="camera_info_topic" value="/camera/camera_info"/>

        <!-- 目标管理 -->
        <param name="target_timeout" value="0.3" />
        <param name="min_stable_frames" value="1" />

        <!-- ========== 坐标变换模式选择 ========== -->
        <!-- true: 使用3D几何变换, false: 使用简单线性映射（原始方法）-->
        <param name="use_3d_transform" value="false" />

        <!-- 3D变换配置文件路径（仅3D模式时需要）-->
        <param name="transform_config_file" value="$(find laser_weeding)/yaml/cam_params.yaml" />
    </node>

    <node pkg="rosbag" type="play" name="play_file2" output="screen"
          args="-d 2 -r 0.8 --quiet /media/zhong/1.0T/harbin/20240809/5.2_harbin/miaojian/miaojian1.bag">
      <remap from="/camera/image_raw" to="/camera/image_raw"/>
    </node>
</launch>